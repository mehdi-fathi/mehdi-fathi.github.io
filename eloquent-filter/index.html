<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Eloquent Filter Document</title>
    <meta name="description" content="Eloquent Filter is a robust Laravel package providing an intuitive way to filter your Eloquent models using query
        strings.">
    <meta name="keywords" content="Laravel, Eloquent Filter, PHP , Eloquent Laravel , Mysql , Laravel framework">
    <link rel="canonical" href="https://mehdi-fathi.github.io/eloquent-filter/">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://mehdi-fathi.github.io/eloquent-filter/">
    <meta property="og:title" content="Eloquent Filter">
    <meta property="og:description" content="Eloquent Filter is a robust Laravel package providing an intuitive way to filter your Eloquent models using query
        strings.">
    <meta property="og:image" content="https://raw.githubusercontent.com/mehdi-fathi/eloquent-filter/develop/eloquent-filter.png">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://mehdi-fathi.github.io/eloquent-filter/">
    <meta property="twitter:title" content="Eloquent Filter">
    <meta property="twitter:description" content="Eloquent Filter is a robust Laravel package providing an intuitive way to filter your Eloquent models using query
        strings.">
    <meta property="twitter:image" content="https://raw.githubusercontent.com/mehdi-fathi/eloquent-filter/develop/eloquent-filter.png">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css">
    <style>
        body {
            font-family: 'Arial', sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 0;
            background: #f4f4f4;
            color: #333;
        }

        .container, .sidebar {
            padding: 20px;
            background: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .container {
            margin-left: 330px; /* Space for the sidebar */
            padding-top: 60px; /* Adjusting for fixed header */
        }

        h1, h2, h3, h4, h5, h6 {
            margin-top: 1em;
            margin-bottom: 0.5em;
        }

        a {
            color: #007bff;
            text-decoration: none;
        }

        a:hover {
            text-decoration: underline;
        }

        /* Sidebar Styles */
        .sidebar {
            position: fixed;
            top: 0;
            left: 0;
            width: 280px;
            height: 100vh;
            overflow-y: auto;
            background-color: #f8f8f8;
            padding: 20px;
            box-shadow: 2px 0 5px rgba(0, 0, 0, 0.1);
        }

        /* Adjusting the link styles for the sidebar */
        .sidebar a {
            display: block;
            color: #007bff;
            padding: 5px 10px;
            text-decoration: none;
            border-radius: 4px;
            margin-bottom: 5px;
            font-size: 14px;
            transition: background-color 0.3s, color 0.3s;
            display: flex;
            align-items: center;
        }

        .sidebar a i {
            margin-right: 8px;
        }

        .sidebar a.active {
            background-color: #007bff;
            color: white;
            border-radius: 4px;
        }

        .sidebar a:hover {
            background-color: #ddd;
            color: #0056b3;
        }

        .sidebar h2 {
            color: #333;
            font-size: 20px;
            margin-bottom: 15px;
        }

        .sidebar ul {
            list-style-type: none;
            padding: 0;
        }

        .sidebar ul ul {
            padding-left: 20px;
        }

        .sidebar li {
            margin-bottom: 5px;
        }

        /* Content Styles */
        code, pre {
            font-family: 'Courier New', monospace;
            background-color: #eee;
            border-radius: 4px;
        }

        code {
            padding: 2px 4px;
        }

        pre {
            border: 1px solid #ddd;
            padding: 10px;
        }

        img {
            max-width: 100%;
            height: auto;
        }

        table {
            width: 100%;
            margin-bottom: 1em;
            border-collapse: collapse;
        }

        th, td {
            padding: 0.5em;
            border: 1px solid #ddd;
        }

        th {
            background-color: #f8f8f8;
        }

    </style>
</head>
<body>
<div class="sidebar">
    <h2 id="tableofcontent">Table of Content</h2>
    <ul>
        <li><a href="#introduction"><i class="fa fa-info-circle"></i> Introduction</a></li>
        <li><a href="#installation"><i class="fa fa-download"></i> Installation</a></li>
        <li>
            <a href="#basicusage"><i class="fa fa-cogs"></i> Basic Usage</a>
            <ul>
                <li><a href="#configmodelandsetwhitelist">Config Model</a></li>
                <li><a href="#useincontroller">Use in Controller</a></li>
                <li><a href="#simpleexamples">Simple Examples</a></li>
                <li><a href="#customqueryfilter">Custom Query Filter</a></li>
                <li><a href="#customdetectionconditions">Custom Detection Condition</a></li>
            </ul>
        </li>
        <li>
            <a href="#configuring"><i class="fa fa-tools"></i> Configuring</a>
            <ul>
                <li><a href="#publishconfig">Publish Config</a></li>
                <li><a href="#config">Config</a></li>
                <li><a href="#alias">Alias</a></li>
            </ul>
        </li>
        <li><a href="#querybuilderintroduction"><i class="fa fa-database"></i> Query Builder</a></li>
        <li>
            <a href="#magicmethods"><i class="fa fa-magic"></i> Magic Methods</a>
            <ul>
                <li><a href="#requestfilter">Request Filter</a></li>
                <li><a href="#responsefilter">Response Filter</a></li>
                <li><a href="#blacklistdetections">Black List Detections</a></li>
                <li><a href="#macromethods">Macro Methods</a></li>
            </ul>
        </li>
    </ul>
</div>

<div class="container">
    <h1 id="eloquentfilterahrefhttpstwittercomintenttweettexteloquent20filter20adds20custom20filters20to20your20eloquent20models20in20laravel26url3dhttps3a2f2fgithubcom2fmehdi-fathi2feloquent-filter26via3dmehdi-fathi26hashtags3dlaravel2celoquent2cphp2cmysql2cdatabase2celoquentfilterimgsrchttpsimgshieldsiotwitterurlhttpshieldsiosvgstylesocialalttweeta">
        Eloquent Filter <a
            href="https://twitter.com/intent/tweet?text=Eloquent%20Filter%20adds%20custom%20filters%20to%20your%20Eloquent%20Models%20in%20Laravel%26url%3Dhttps%3A%2F%2Fgithub.com%2Fmehdi-fathi%2Feloquent-filter%26via%3Dmehdi-fathi%26hashtags%3Dlaravel%2Celoquent%2Cphp%2Cmysql%2Cdatabase%2Celoquentfilter"><img
            src="https://img.shields.io/twitter/url/http/shields.io.svg?style=social" alt="Tweet"/></a></h1>
    <p><img src="https://raw.githubusercontent.com/mehdi-fathi/eloquent-filter/develop/eloquent-filter.png"
            alt="alt text" title="eloquent-filter"/></p>
    <p><a href="https://packagist.org/packages/mehdi-fathi/eloquent-filter"><img
            src="https://img.shields.io/packagist/v/mehdi-fathi/eloquent-filter" alt="Latest Stable Version"/></a>
        <img src="https://github.com/mehdi-fathi/eloquent-filter/workflows/Run%20tests/badge.svg?branch=master"
             alt="Run tests"/>
        <a href="https://packagist.org/packages/mehdi-fathi/eloquent-filter"><img
                src="https://poser.pugx.org/mehdi-fathi/eloquent-filter/license" alt="License"/></a>
        <a href="https://github.com/mehdi-fathi/eloquent-filter/stargazers"><img
                src="https://img.shields.io/github/stars/mehdi-fathi/eloquent-filter" alt="GitHub stars"/></a>
        <a href="https://packagist.org/packages/mehdi-fathi/eloquent-filter"><img
                src="https://img.shields.io/packagist/dm/mehdi-fathi/eloquent-filter?color=blue"
                alt="Monthly Downloads"/></a>
        <a href="https://scrutinizer-ci.com/g/mehdi-fathi/eloquent-filter/?branch=master"><img
                src="https://scrutinizer-ci.com/g/mehdi-fathi/eloquent-filter/badges/quality-score.png?b=master"
                alt="Scrutinizer Code Quality"/></a>
        <a href="https://codecov.io/gh/mehdi-fathi/eloquent-filter"><img
                src="https://codecov.io/gh/mehdi-fathi/eloquent-filter/branch/develop/graph/badge.svg?token=QY9HA6NXFH"
                alt="codecov"/></a></p>
    <p>Eloquent Filter is a robust Laravel package providing an intuitive way to filter your Eloquent models using query
        strings.
        Perfect for crafting responsive APIs and complex data sets, this package seamlessly integrates with Laravel's
        existing Eloquent models,
        adding powerful and dynamic filtering capabilities with minimal setup.</p>
    <p>Features:</p>
    <ul>
        <li>Support for complex query structures</li>
        <li>Easy to override conditions for custom behavior</li>
        <li>Harmonious integration with Laravel and Eloquent, including query builders</li>
        <li>Full control over filter execution and customization</li>
    </ul>
    <p>We've tailored Eloquent Filter to be as flexible as you needâ€”whether your queries are straightforward or complex.
        With an extensive feature set, you can implement specific functionalities unique to your application with
        ease.</p>
    <p><strong>Note</strong> We considered what predictable features you wanted to implement no matter simple or
        complex,
        although we have a lot of features to make able you to implement your specific something else.</p>

    <h2 id="requirements">Requirements</h2>
    <ul>
        <li>PHP 8.0,8.1,8.2</li>
        <li>Laravel 8.x,9.x,10.x(New)</li>
    </ul>
    <h3 id="versioninformation">Version information</h3>
    <p>The Eloquent Filter has reached more than 100,000 installations recently, so I made a decision to release version
        4.0 with 2 new features.</p>
    <p>The current version supports:</p>
    <ul>
        <li>Support query builder along with eloquent</li>
        <li>Set a specific name for custom methods</li>
    </ul>
    <table>
        <thead>
        <tr>
            <th>Version</th>
            <th>Illuminate</th>
            <th>Status</th>
            <th>PHP Version</th>
        </tr>
        </thead>
        <tbody>
        <tr>
            <td>^4.0</td>
            <td>4.x.x - 4.x.x</td>
            <td>Active support</td>
            <td>&gt;= 8.0</td>
        </tr>
        <tr>
            <td>^3.0</td>
            <td>3.2.x - 3.4.x</td>
            <td>End of life</td>
            <td>&gt;= 8.0</td>
        </tr>
        <tr>
            <td>^3.0</td>
            <td>3.0.0 - 3.0.5</td>
            <td>End of life</td>
            <td>&gt;= 7.4.0</td>
        </tr>
        <tr>
            <td>^2.0</td>
            <td>2.0.0 - 2.6.7</td>
            <td>End of life</td>
            <td>&lt;= 7.4.0</td>
        </tr>
        </tbody>
    </table>
    <h2 id="introduction">Introduction</h2>
    <p>Conceivably, you would face challenges if you've done a task as an end-point in which there are some queries with
        many advanced options.</p>
    <p>Let's say we want to make an advanced search page with multiple filter options.</p>
    <p>
        <img src="https://raw.githubusercontent.com/mehdi-fathi/eloquent-filter/develop/Aban-21-1402%2014-27-04.gif"
             alt="alt text" title="sample 1 eloquent-filter"/></p>
    <h3 id="asimpleimplementationwithouteloquentfilter">A simple implementation without Eloquent Filter</h3>
    <p>The Resource URI would be look like:
        /users/index?age_more_than=25&amp;gender=male&amp;created_at=25-09-2019</p>
    <p>And a simple implementation in the Controller would look like :</p>
    <pre><code class="language-php">&lt;?php

namespace App\Http\Controllers;

use App\User;
use Illuminate\Http\Request;

class UserController extends Controller
{
    public function index(Request $request)
    {
        $users = User::where('is_active', true);

        if ($request-&gt;has('age_more_than')) {
            $users-&gt;where('age', '&gt;', $request-&gt;age_more_than);
        }

        if ($request-&gt;has('gender')) {
            $users-&gt;where('gender', $request-&gt;gender);
        }

        if ($request-&gt;has('created_at')) {
            $users-&gt;where('created_at','&gt;=', $request-&gt;created_at);
        }

        return json_encode($users-&gt;get());
    }
}
</code></pre>
    <p>This solution is simple and that works well but not for an enterprise project.
        But you'd have to add a condition for each filter you need.
        Especially if you would make more complex filtering, your code can become a monster quickly! :boom:</p>
    <p>Hence, Eloquent Filter is ready for to you get rid of complexity in addition to saving time.</p>
    <h3 id="asimpleimplementationwitheloquentfilter">A simple implementation with Eloquent Filter</h3>
    <p>Eloquent Filter can help you to fix that ``problem. Just you will set query string to work with that.
        It would make your own query automatically and systematically while you can control them.</p>
    <p>Right After installing Eloquent Filter, the request URI would be like this:
        /users/list?age_more_than[operator]=&gt;&amp;age[value]=35&amp;gender=male&amp;created_at[operator]==&gt;&amp;created_at[value]=25-09-2019</p>
    <p>And in the Controller, You just need that one line:</p>
    <pre><code class="language-php">/**
 * Class UsersController.
 */

namespace App\Http\Controllers;

use App\User;

class UsersController
{
    public function list()
    {
        return User::filter()-&gt;get();
    }
}
</code></pre>
    <p>By Eloquent filter implementation, you can use all the documented filters!</p>
    <h2 id="installation">Installation</h2>
    <p>1- Run the following command in your project directory to add the Eloquent Filter as a dependency</p>
    <pre><code>    $ composer require mehdi-fathi/eloquent-filter
  </code></pre>
    <ul>
        <li><p><strong>Note</strong> for Laravel versions older than 5.8 you should install version 2.2.5</p>
            <pre><code>  $ composer require mehdi-fathi/eloquent-filter:2.2.5</code></pre>
        </li>
        <li><p><strong>Note</strong> We support auto-discovery but you can check them.</p>
        </li>
    </ul>
    <p>2- Add <code>eloquentFilter\ServiceProvider::class</code> to provider app.php</p>
    <pre><code class="language-php">'providers' =&gt; [
  /*
   * Package Service Providers...
   */
    eloquentFilter\ServiceProvider::class
]
</code></pre>
    <p>3- Add Facade <code>'EloquentFilter' =&gt; eloquentFilter\Facade\EloquentFilter::class</code> to aliases app.php
    </p>
    <pre><code class="language-php">'alias' =&gt; [
  /*
   * Facade alias...
   */
    'EloquentFilter' =&gt; eloquentFilter\Facade\EloquentFilter::class,
],
</code></pre>
    <p>That's it enjoy! :boom:</p>
    <h2 id="basicusage">Basic Usage</h2>
    <h3 id="configmodelandsetwhitelist">Config Model and set whitelist</h3>
    <p>Add the <code>Filterable</code> trait to yourself models and set fields in the whitelist array in which you will
        want to use of filter .
        You can override this method in your models as well.</p>
    <pre><code class="language-php">use eloquentFilter\QueryFilter\ModelFilters\Filterable;

class User extends Model
{
    use Filterable;

    private static $whiteListFilter =[
        'id',
        'username',
        'email',
        'created_at',
        'updated_at',
    ];
}
</code></pre>
    <ul>
        <li>You can set <code>*</code> char for that filter in all fields aslike below example:</li>
    </ul>
    <pre><code class="language-php">private static $whiteListFilter = ['*'];
</code></pre>
    <p>You able add or set <code>$whiteListFilter</code> on the fly in your method. For example:</p>
    <p><em><strong>Set array to WhiteListFilter</strong></em></p>
    <ul>
        <li><strong>Note</strong> This method override <code>$whiteListFilter</code> array</li>
    </ul>
    <pre><code class="language-php">User::setWhiteListFilter(['name']);
</code></pre>
    <p><em><strong>Add new field to WhiteListFilter</strong></em></p>
    <pre><code class="language-php">User::addWhiteListFilter('name');
</code></pre>
    <h3 id="useincontroller">Use in Controller</h3>
    <p>Change your code the controller of the laravel project as like below example:</p>
    <pre><code class="language-php">
namespace App\Http\Controllers;

/**
 * Class UsersController.
 */
class UsersController
{

    public function list()
    {
          if (!empty(request()-&gt;get('username'))) {

              $users = User::ignoreRequest('perpage')
                        -&gt;filter()
                        -&gt;with('posts')
                        -&gt;orderByDesc('id')
                        -&gt;paginate(request()-&gt;get('perpage'),['*'],'page');

          } else {
              $users = User::filter(
                ['username' =&gt; ['mehdi','ali']]
                )-&gt;with('posts')
                -&gt;orderByDesc('id')
                -&gt;paginate(10,['*'],'page');
          }
    }
}
</code></pre>
    <p>-<strong>Note</strong> The Eloquent Filter config by default uses the query string to make queries in Laravel.
        Although, you can set the collection data in the <code>filter</code> method Model for making your own custom
        condition without query string.</p>
    <p>-<strong>Note</strong> Therefore you must unset yourself param as perpage. Just you can set page param for
        paginate this param ignore from the filter.</p>
    <ul>
        <li>You can ignore some request params via use of the bellow code.</li>
    </ul>
    <pre><code class="language-php">
User::ignoreRequest(['perpage'])
            -&gt;filter()
            -&gt;paginate(request()-&gt;get('perpage'), ['*'], 'page');
</code></pre>
    <p>Call <code>ignoreRequest</code> that will ignore some requests that you don't want to use in conditions of
        eloquent filter.
        e.g: the perpage param will never be in the conditions eloquent filter.
        it's related to the paginate method. <code>page</code> param ignore by default in Eloquent Filter of Laravel.
    </p>
    <ul>
        <li>You can filter some request params as acceptable filter.</li>
    </ul>
    <pre><code class="language-php">
User::AcceptRequest(['username','id'])
            -&gt;filter()
            -&gt;paginate(request()-&gt;get('perpage'), ['*'], 'page');
</code></pre>
    <p>Call <code>AcceptRequest</code> will accept requests in which you want to use in conditions Eloquent Filter.
        e.g: <code>username</code> and <code>id</code> key will be in the conditions eloquent filter.</p>
    <p>-<strong>Note</strong> Just in case, you must set <code>$whiteListFilter</code> in Models. Aim of the method
        avert to manipulation query string by a bad user.</p>
    <h3 id="simpleexamples">Simple Examples</h3>
    <p>You just pass data form as query string. For example:</p>
    <p><strong>Simple Where</strong></p>
    <pre><code>/users/list?email=mehdifathi.developer@gmail.com

SELECT ... WHERE ... email = 'mehdifathi.developer@gmail.com'
</code></pre>
    <pre><code>/users/list?first_name=mehdi&amp;last_name=fathi

SELECT ... WHERE ... first_name = 'mehdi' AND last_name = 'fathi'
</code></pre>
    <ul>
        <li>If you send date format <code>Y-m-d</code> we will work like <code>WhereDate()</code> method Laravel.</li>
    </ul>
    <p><em><strong>Where In</strong></em></p>
    <p>This example make method <code>whereIn</code>.</p>
    <pre><code>/users/list?username[]=ali&amp;username[]=ali22&amp;family=ahmadi

SELECT ... WHERE ... username in ('ali','ali22') AND family = 'ahmadi'
</code></pre>
    <p><em><strong>OrWhere</strong></em></p>
    <p>This example make method <code>orWhere()</code>.</p>
    <pre><code>/users/list?name=mehdi&amp;username=fathi&amp;or[username]=ali

SELECT ... WHERE ... name = 'mehdi' AND username = 'fathi' or username = 'ali'
</code></pre>
    <p><em><strong>Where like</strong></em></p>
    <p>If you are going to make a query by like conditions. You can do that by this example.</p>
    <pre><code>/users/list?first_name[like]=%John%

SELECT ... WHERE ... first_name LIKE '%John%'

</code></pre>
    <p><em><strong>Where by operator</strong></em></p>
    <p>You can set any operator mysql in the queries string.</p>
    <pre><code>/users/list?count_posts[operator]=&gt;&amp;count_posts[value]=35

SELECT ... WHERE ... count_posts &gt; 35
</code></pre>
    <pre><code>/users/list?username[operator]=!=&amp;username[value]=ali

SELECT ... WHERE ... username != 'ali'
</code></pre>
    <pre><code>/users/list?count_posts[operator]=&lt;&amp;count_posts[value]=25

SELECT ... WHERE ... count_posts &lt; 25
</code></pre>
    <p><strong>Where the nested relations Model</strong></p>
    <p>You can set all nested relations in the query string just via the array of query string. imagine, the user model
        has a relation with posts.
        And posts table has a relation with orders table.</p>
    <p>You can make query conditions by set <code>posts[count_post]</code> and <code>posts[orders][name]</code> in the
        query string.</p>
    <ul>
        <li>Just be careful you must set <code>posts.count_post</code> and <code>posts.orders.name</code> in the User
            model.
        </li>
    </ul>
    <pre><code class="language-php">use eloquentFilter\QueryFilter\ModelFilters\Filterable;

class User extends Model
{
    use Filterable;

    private static $whiteListFilter =[
        'username',
        'posts.count_post',
        'posts.category',
        'posts.orders.name',
    ];

    /**
     * @return \Illuminate\Database\Eloquent\Relations\belongsTo
     */
    public function posts()
    {
        return $this-&gt;belongsTo('Models\Post');
    }

}
</code></pre>
    <pre><code>/users/list?posts[count_post]=876&amp;username=mehdi

select * from &quot;users&quot; where exists
         (select * from &quot;posts&quot; where &quot;posts&quot;.&quot;user_id&quot; = &quot;users&quot;.&quot;id&quot;
         and &quot;posts&quot;.&quot;count_post&quot; = 876)
         and &quot;username&quot; = &quot;mehdi&quot;
</code></pre>
    <ul>
        <li>The above example is the same code that you used without the eloquent filter. Check it under code. It's not
            amazing?
        </li>
    </ul>
    <pre><code class="language-php">$builder = (new User())-&gt;with('posts');
        $builder-&gt;whereHas('posts', function ($q) {
            $q-&gt;where('count_post', 876);
        })-&gt;where('username','mehdi');

</code></pre>
    <p><em><strong>Where array the nested relation Model</strong></em></p>
    <p>You can pass array to make whereIn condition.</p>
    <pre><code>/users/list?posts[category][]=php&amp;posts[category][]=laravel&amp;posts[category][]=jquery&amp;username=mehdi

select * from &quot;users&quot; where exists
         (select * from &quot;posts&quot; where
         &quot;posts&quot;.&quot;category&quot; in ('php','laravel','jquery') )
         and &quot;username&quot; = &quot;mehdi&quot;
</code></pre>
    <p>****Special Params****</p>
    <p>You can set special params <code>limit</code> and <code>orderBy</code> in the query string to make a query by
        that.</p>
    <pre><code>/users/list?f_params[limit]=1

SELECT ... WHERE ... order by `id` desc limit 1 offset 0
</code></pre>
    <pre><code>/users/list?f_params[orderBy][field]=id&amp;f_params[orderBy][type]=ASC

SELECT ... WHERE ... order by `id` asc
</code></pre>
    <pre><code>/users/list?f_params[orderBy][field]=id,count_posts&amp;f_params[orderBy][type]=ASC

SELECT ... WHERE ...  order by `id` asc, `count_posts` asc
</code></pre>
    <p><em><strong>Where between</strong></em></p>
    <p>If you are going to make a query based on date, You must fill keys, <code>start</code>, and <code>end</code> in
        the query string.
        Hence You can set it as a query string. These params are used for the filter by date.</p>
    <pre><code>/users/list?created_at[start]=2016/05/01&amp;created_at[end]=2017/10/01

SELECT ... WHERE ... created_at BETWEEN '2016/05/01' AND '2017/10/01'
</code></pre>
    <p>****Advanced Where****</p>
    <pre><code>/users/list?count_posts[operator]=&gt;&amp;count_posts[value]=10&amp;username[]=ali&amp;
    username[]=mehdi&amp;family=ahmadi&amp;
    created_at[start]=2016/05/01&amp;created_at[end]=2020/10/01
&amp;f_params[orderBy][field]=id&amp;f_params[orderBy][type]=ASC

select * from `users` where `count_posts` &gt; 10
    and `username` in ('ali', 'mehdi') and
`family` = ahmadi and `created_at` between '2016/05/01' and '2020/10/01'
    order by 'id' asc limit 10 offset 0
</code></pre>
    <p>Therefore, fields of query string are same rows table database in <code>$whiteListFilter</code> in your model or
        declare the method in your model as override method.
        The overridden method can be considered a custom query filter.</p>
    <h3 id="customqueryfilter">Custom Query Filter</h3>
    <p>Eloquent Filter doesn't support all the conditions by default. For this situation, you can make an overridden
        method.
        If you are going to make yourself a query filter, you can do it easily.
        You should take care of using <code>filterCustom</code> before method name in new version.</p>
    <p>You should run the command to make a trait and use it on the model:</p>
    <pre><code>php artisan eloquentFilter:filter users</code></pre>
    <pre><code class="language-php">namespace App\ModelFilters;

use Illuminate\Database\Eloquent\Builder;

/**
 * Trait UsersFilter.
 */
trait UsersFilter
{
    /**
     * This is a sample custom query
     * @param \Illuminate\Database\Eloquent\Builder $builder
     * @param                                       $value
     *
     * @return \Illuminate\Database\Eloquent\Builder
     */
    public function filterCustomSample_like(Builder $builder, $value)
    {
        return $builder-&gt;where('username', 'like', '%'.$value.'%');
    }
}
</code></pre>
    <p>-<strong>Note</strong> These fields of query string are the same methods of the trait. Use trait in your model:
    </p>
    <pre><code>/users/list?sample_like=a

select * from `users` where `username` like %a%
order by `id` desc limit 10 offset 0
</code></pre>
    <pre><code class="language-php">
use App\ModelFilters\UsersFilter;

class User extends Model
{
    use UsersFilter,Filterable;

    protected $table = 'users';
    protected $guarded = [];
    private static $whiteListFilter =[
        'id',
        'username',
        'email',
        'created_at',
        'updated_at',
    ];

}
</code></pre>
    <h3 id="somefiltermethods">Some Filter methods</h3>
    <pre><code class="language-php">User::filter()-&gt;paginate();
</code></pre>
    <ul>
        <li><p><code>EloquentFilter::filterRequests()</code> : get all params that used by the Eloquent Filter.
            You can set key to get specific index.
            For example <code>EloquentFilter::filterRequests('username')</code> it's getting username index.</p>
        </li>
        <li><p><code>EloquentFilter::getAcceptedRequest()</code> : get all params that set by the AcceptRequest method.
        </p>
        </li>
        <li><p><code>EloquentFilter::getIgnoredRequest()</code> : get all ignored params that set by the
            getIgnoreRequest method.</p>
        </li>
    </ul>
    <h3 id="customdetectionconditions">Custom Detection Conditions</h3>
    <p>Sometimes you want to make your custom condition to make a new query that Eloquent Filter doesn't support by
        default.
        The good news is you would make a custom condition in the eloquent filter from now on.</p>
    <p>You can make conditions to generate a new query after checking by that. For example:</p>
    <p>We must have two classes. The First detects conditions second class generates the query.</p>
    <ul>
        <li>Step 1: Create a class to detect some conditions</li>
    </ul>
    <pre><code class="language-php">
use eloquentFilter\QueryFilter\Detection\Contract\DetectorConditionsContract;

/**
 * Class WhereRelationLikeCondition.
 */
class WhereRelationLikeCondition implements DetectorConditionsContract
{
    /**
     * @param $field
     * @param $params
     * @param $is_override_method
     *
     * @return string|null
     */
    public static function detect($field, $params, $is_override_method = false)
    : ?string
    {
        if (!empty($params['value']) &amp;&amp; !empty($params['limit'])
            &amp;&amp; !empty($params['email'])) {
            $method = WhereRelationLikeConditionQuery::class;
        }

        return $method ?? null;
    }
}
</code></pre>
    <ul>
        <li>Step 2:Right after, create a class to generate a query. In this example we make <code>WhereRelationLikeConditionQuery</code>
            class:
        </li>
    </ul>
    <pre><code class="language-php">use eloquentFilter\QueryFilter\Queries\BaseClause;
use Illuminate\Database\Eloquent\Builder;

/**
 * Class WhereRelationLikeConditionQuery.
 */
class WhereRelationLikeConditionQuery extends BaseClause
{
    /**
     * @param $query
     *
     * @return Builder
     */
    public function apply($query): Builder
    {
        return $query
            -&gt;whereHas('posts', function ($q) {
                $q-&gt;where('comment', 'like', &quot;%&quot; .
                $this-&gt;values['like_relation_value'] . &quot;%&quot;);
            })
            -&gt;where(&quot;$this-&gt;filter&quot;, '&lt;&gt;', $this-&gt;values['value'])
            -&gt;where('email', 'like', &quot;%&quot; . $this-&gt;values['email'] . &quot;%&quot;)
            -&gt;limit($this-&gt;values['limit']);
    }
}
</code></pre>
    <ul>
        <li>Step 3: You make the method <code>EloquentFilterCustomDetection</code> for return array detections of the
            condition in the model.
        </li>
    </ul>
    <pre><code class="language-php">use eloquentFilter\QueryFilter\ModelFilters\Filterable;

class User extends Model
{
    use Filterable;

    private static $whiteListFilter =[
        'username',
        'posts.count_post',
        'posts.category',
        'posts.orders.name',
    ];

    /**
     * @return \Illuminate\Database\Eloquent\Relations\belongsTo
     */
    public function posts()
    {
        return $this-&gt;belongsTo('Models\Post');
    }

    public function EloquentFilterCustomDetection(): array
    {
        return [
            WhereRelationLikeCondition::class
        ];
    }

}
</code></pre>
    <ul>
        <li>Each of the query params is used to detect in <code>WhereRelationLikeCondition</code> for the first time
            after that check by default detection eloquent filter.
        </li>
    </ul>
    <p>Make method <code>EloquentFilterCustomDetection</code> in the above example and return array conditions class.
    </p>
    <pre><code>/users/list?username[value]=mehdi&amp;username[limit]=10
            &amp;username[email]=mehdifathi&amp;
            username[like_relation_value]=mehdi&amp;count_posts=10

select * from &quot;users&quot;
 where exists (select * from &quot;posts&quot; where
&quot;users&quot;.&quot;post_id&quot; = &quot;posts&quot;.&quot;id&quot;
and &quot;comment&quot; like ?) and &quot;username&quot; &lt;&gt; ? and &quot;email&quot; like ? and &quot;count_posts&quot; = ?
    limit 10
</code></pre>
    <p>You just run code <code> User::filter();</code> for see result.</p>
    <ul>
        <li><code>Model::setLoadInjectedDetection(false)</code> : You can deactivate custom detection conditions on the
            fly.
        </li>
    </ul>
    <p>-<strong>Note</strong> as well, you can set custom detection on the fly by use of the method <code>SetCustomDetection</code>.
        For example :</p>
    <pre><code class="language-php">$users = User::SetCustomDetection([WhereRelationLikeCondition::class])-&gt;filter();
</code></pre>
    <p>-<strong>Note</strong> You can disable <code>EloquentFilterCustomDetection</code> on the fly by this code :</p>
    <pre><code class="language-php"> User::SetLoadDefaultDetection(false)-&gt;filter();
</code></pre>
    <p>-<strong>Note</strong> You can set many detection conditions. e.g:</p>
    <pre><code class="language-php">
class User extends Model
{
    use Filterable;
    public function EloquentFilterCustomDetection(): array
    {
        return [
            WhereRelationLikeCondition::class,
            WhereRelationLikeVersion2Condition::class,
            WhereRelationLikeVersion3Condition::class,
        ];
    }
}
</code></pre>
    <ul>
        <li><code>EloquentFilter::getInjectedDetections()</code> gets all of your customs injected detection.</li>
    </ul>
    <p>-<strong>Note</strong> Every custom detection will run before any detections by default eloquent filter.</p>
    <h2 id="configuring">Configuring</h2>
    <p>You can publish the configuration file to customize the package further:</p>
    <h3 id="publishconfig">Publish Config</h3>
    <pre><code>php artisan vendor:publish --provider=&quot;eloquentFilter\ServiceProvider&quot;</code></pre>
    <h3 id="config">Config</h3>
    <ul>
        <li><p>You can disable/enable Eloquent Filter in the config file (eloquentFilter.php).</p>
            <pre><code>  'enabled' =&gt; env('EloquentFilter_ENABLED', true),</code></pre>
        </li>
        <li><p>Eloquent Filter recognizes every param of the queries string.
            Maybe you have a query string that you don't want to recognize by Eloquent Filter. You can use <code>ignoreRequest</code>
            for his purpose.
            But we have a clean solution to this problem. You can set param <code>request_filter_key</code> in the
            config file.
            Therefore, every query string will recognize by the <code>request_filter_key</code> param.</p>
            <pre><code>  'request_filter_key' =&gt; '', // filter</code></pre>
        </li>
    </ul>
    <p>For example, if you set <code>'request_filter_key' =&gt; 'filter',</code> that Eloquent Filter recognizes <code>filter</code>
        query string.</p>
    <p><code> /users/list?filter[email]=mehdifathi.developer@gmail.com</code></p>
    <ul>
        <li><p>You can disable/enable all the custom detection of Eloquent Filter in the config file
            (eloquentFilter.php).</p>
            <pre><code>  'enabled_custom_detection' =&gt;
    env('EloquentFilter_Custom_Detection_ENABLED', true),</code></pre>
        </li>
        <li><p>You should set an index array <code>ignore_request</code> to ignore all filters.</p>
            <pre><code>  'ignore_request' =&gt; [] //[ 'show_query','new_trend' ],</code></pre>
        </li>
        <li><p>You had better keep <code>max_limit</code>. It's a limitation for preventing making awful queries
            mistakenly by the developer or intentionally by a villain user.</p>
            <pre><code>  'max_limit' =&gt; 20 </code></pre>
        </li>
        <li><p>From now on , we have the ability to record logs by logger instance. Since queries is made dynamically
            somehow , the need of feature keeping queries with their time is required.
            So we added it in this version with some other options to better management.</p>
            <pre><code>  'log' =&gt; [
  'has_keeping_query' =&gt; false,
  'max_time_query' =&gt; null,
  'type' =&gt; 'eloquentFilter.query']</code></pre>
            <p>It's disable by default you enable by <code>has_keeping_query</code>, <code>type</code> is type log ,and
                <code>max_time_query</code> is a value for keeping queries with high time-executed.</p>
        </li>
    </ul>
    <h3 id="alias">Alias</h3>
    <p>Sometimes you may want to change some parameters in the URL while those mention a field of the model.
        e.g. name of the input form is not similar to the model ,or you want to change them for other reasons so the
        alias as a new feature can be useful.</p>
    <pre><code class="language-php">
    class Stat extends Model
    {
        use Filterable;
        /**
         * @var array
         */
        private static $whiteListFilter = [
            'type',
            'national_code',
        ];

        /**
         * @var array
         */
        private $aliasListFilter = [
            'national_code' =&gt; 'code',
        ];
    }

</code></pre>
    <p>Then you should send the <code>code</code> param in the URL for making a query with the national code field of
        the model readily.</p>
    <h1 id="querybuilderintroduction">Query Builder Introduction</h1>
    <p>Great news!</p>
    <p>Some people asked me a lot to add new feature to support Laravel query builder.
        It needed a lot of energy and devoting time , so I decided to implement it.
        It's quite tough however finally it's almost done now.</p>
    <p>We are supporting query builder along with eloquent from now on. Not only you would use query builder ,but also
        you can use eloquent at the same time.</p>
    <p>It's a new feature ,and I'm snowed under the code to fix issues. Anyway this feature is up right now with just
        some limitation.
        We don't support <code>WhereCustomCondition</code> and <code>WhereHas</code> for query builder at the moment but
        other conditions were ready to use.
        in addition, we don't have any kind of <code>whitelist</code> , <code>blacklist</code> , <code>custom
            detectioon</code> or <code>alias</code>.
        currently , It's just a simple feature.</p>
    <ul>
        <li>Below is an order checking conditions list if you use name of them for set a black list.</li>
    </ul>
    <p>| Name | Method eloquent | Example |
        |-----------------------|-----------------|------------------------------------------|
        | SpecialCondition | | support f_params, e.g: limit and order |
        | WhereBetweenCondition | whereBetween | |
        | WhereByOptCondition | where | where('column', &quot;&gt;&quot;, $value) |
        | WhereLikeCondition | where | where('column', 'like', $value) |
        | WhereInCondition | whereIn | whereIn('column', $value) |
        | WhereOrCondition | orWhere | orWhere('column', $value) |
        | WhereDateCondition | whereDate | whereDate('column', $value) |
        | where | where | where('column', $value) |</p>
    <ul>
        <li>Usage of them is just extremely like model just you need use filter as a method. Obviously, there's no need
            any change like use trait or etc.
        </li>
    </ul>
    <pre><code class="language-php"> DB::table('users')-&gt;filter();
</code></pre>
    <h2 id="magicmethods">Magic Methods</h2>
    <p>Magic methods are a collection of methods that you can use as a wrapper in the Eloquent Filter.
        For example, serialize data before filtering or changing data in response and others.
        Now Eloquent Filter have <code>serializeRequestFilter</code>,<code>ResponseFilter</code>.</p>
    <h3 id="requestfilter">Request Filter</h3>
    <p>Eloquent Filter has a magic method for just change requests injected before handling by eloquent filter. This
        method is
        SerializeRequestFilter. You just implement <code>SerializeRequestFilter</code> method in your Model. For example
    </p>
    <pre><code class="language-php">
class User extends Model
{
    use Filterable;
    public function serializeRequestFilter($request)
    {
       $request['username'] = trim($request['username']);
       return $request;
    }
}
</code></pre>
    <p>As above code, you can modify every query params of the Model in the method <code>serializeRequestFilter</code>
        before running by Eloquent Filter.
        That is a practical method when you want to set user_id or convert date or remove space and others.</p>
    <h3 id="responsefilter">Response Filter</h3>
    <p>Response Filter is an overriding method for changing response right after handle by Eloquent Filter. The method
        called
        <code>getResponseFilter</code> and You could implement the method <code>getResponseFilter</code> in your Model.
        e.g:</p>
    <pre><code class="language-php">
class User extends Model
{
    use Filterable;
    public function getResponseFilter($response)
    {
        $data['data'] = $response;
        return $data;
    }
}
</code></pre>
    <h3 id="blacklistdetections">Black List Detections</h3>
    <p>Obviously, you never want all users who are able to get data by manipulating requests. As a result, we'd better
        have
        an eloquent control feature.
        Although we have this ability on request side, we need this feature on Eloquent side as well.</p>
    <p>We would set a blacklist detection to prevent making conditions by using it. Therefore, that list has been
        disabled in making conditions. for example:</p>
    <pre><code class="language-php">
namespace App\Http\Controllers;

/**
 * Class UsersController.
 */
class UsersController
{

    public function list()
    {
              $users = User::setBlackListDetection(
                  [
                      'WhereCondition',
                  ]
                )-&gt;filter()
                -&gt;orderByDesc('id')
                -&gt;paginate();
    }
}
</code></pre>
    <ul>
        <li>Below is an order checking conditions list if you use name of them for set a black list.</li>
    </ul>
    <table>
        <thead>
        <tr>
            <th>Name</th>
            <th>Method eloquent</th>
            <th>Example</th>
        </tr>
        </thead>
        <tbody>
        <tr>
            <td>WhereCustomCondition</td>
            <td></td>
            <td>Your declared custom method of Model</td>
        </tr>
        <tr>
            <td>SpecialCondition</td>
            <td></td>
            <td>support f_params, e.g: limit and order</td>
        </tr>
        <tr>
            <td>WhereBetweenCondition</td>
            <td>whereBetween</td>
            <td></td>
        </tr>
        <tr>
            <td>WhereByOptCondition</td>
            <td>where</td>
            <td>where('column', "&gt;", $value)</td>
        </tr>
        <tr>
            <td>WhereLikeCondition</td>
            <td>where</td>
            <td>where('column', 'like', $value)</td>
        </tr>
        <tr>
            <td>WhereInCondition</td>
            <td>whereIn</td>
            <td>whereIn('column', $value)</td>
        </tr>
        <tr>
            <td>WhereOrCondition</td>
            <td>orWhere</td>
            <td>orWhere('column', $value)</td>
        </tr>
        <tr>
            <td>WhereHas</td>
            <td>WhereHas</td>
            <td></td>
        </tr>
        <tr>
            <td>WhereDateCondition</td>
            <td>whereDate</td>
            <td>whereDate('column', $value)</td>
        </tr>
        <tr>
            <td>where</td>
            <td>where</td>
            <td>where('column', $value)</td>
        </tr>
        </tbody>
    </table>
    <ul>
        <li>You are able to set on Model layer as well. <code>black_list_detections</code> array is used for this
            purpose.
        </li>
    </ul>
    <pre><code class="language-php">&lt;?php

namespace Tests\Models;

use eloquentFilter\QueryFilter\ModelFilters\Filterable;
use Illuminate\Database\Eloquent\Model;

class Car extends Model
{
    use Filterable;

    private static $whiteListFilter = '*';

    protected $black_list_detections = [
        'WhereCondition',
    ];
}
</code></pre>
    <h3 id="macromethods">Macro Methods</h3>
    <p>-<code>isUsedEloquentFilter</code> is a macro method for builder to check either query used eloquent-filter.</p>
    <p>-<code>getDetectionsInjected</code> is a macro method to get list array of injected objects.</p>
    <p>e.g:</p>
    <pre><code class="language-php">$users = User::SetCustomDetection([WhereRelationLikeCondition::class])-&gt;filter();
echo $users-&gt;isUsedEloquentFilter(); // will true
echo $users-&gt;getDetectionsInjected();
// will showing a list array of injected objects
</code></pre>
    <h2 id="contributing">Contributing</h2>
    <p>If you'd like to contribute to Eloquent Filter, please fork the repository and create a pull request. We welcome
        contributions of all kinds, including bug fixes, new features, and documentation improvements.</p>
    <h2 id="license">License</h2>
    <p>Eloquent Filter is open-source software licensed under the <a href="https://opensource.org/licenses/MIT">MIT
        license</a>.</p>
    <h2 id="contact">Contact</h2>
    <p>If you have any questions or feedback about Eloquent Filter, please feel free to contact us at
        mehdifathi.developer@gmail.com. We'd love to hear from you!</p>
    <h2 id="acknowledgements">Acknowledgements</h2>
    <p>We'd like to thank the Laravel community for their support and contributions to this project.</p>

</div>
</body>
</html>
<script>
    // Smooth scrolling for anchor links
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
            e.preventDefault();
            document.querySelector(this.getAttribute('href')).scrollIntoView({
                behavior: 'smooth'
            });
        });
    });

    // Function to check if an element is in viewport
    function isInViewport(element) {
        const rect = element.getBoundingClientRect();
        return (
            rect.top >= 0 &&
            rect.left >= 0 &&
            rect.bottom <= (window.innerHeight || document.documentElement.clientHeight) &&
            rect.right <= (window.innerWidth || document.documentElement.clientWidth)
        );
    }

    window.addEventListener('scroll', () => {
        document.querySelectorAll('.sidebar a').forEach(link => {
            const section = document.querySelector(link.hash);
            if (section && isInViewport(section)) {
                link.classList.add('active');
            } else {
                link.classList.remove('active');
            }
        });
    });

</script>

</div>
</body>
</html>
